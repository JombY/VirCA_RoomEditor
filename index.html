<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>VirCA Room Editor</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/index_style.css">


</head>
<body>
    <div id="image">
        <img src="vircalogo.png" width="300px"><br><br>
    </div>
    <div id="url" centered>
        <label>Select your room file from the following list: </label><br>
        <div class="fl" id="choiceTree"></div>
        <a id="btn-submit" class="btn btn-default f1">Letâ€™s get started!</a>
    </div>

</body>
<script type="text/javascript">
    window.$ = window.jQuery = require('jQuery');
    var chooser = MakeTreeStructure();
    var roomPath = "";
    $('#btn-submit').on("click", function(){
        roomPath = $("input[type='radio'][name='myChoice']:checked").val();
        sessionStorage.setItem('roomPath', roomPath);
        window.location = "./settings.html";
    });


    function MakeTreeStructure(){
        console.log("Lefutottam;");

        var glob = require("glob");
        var dirs = getDirectories("C:/Users/Public/Documents/VirCA/");
        console.log(dirs);
        var rooms = [];
        $('#choiceTree').append('<ul id="choiceTreeUL"></ul>');
        for(var i = 0; i < dirs.length; ++i){
            console.log(i);
            rooms[i] = [];
            rooms[i] = glob.sync("C:/Users/Public/Documents/VirCA/"+dirs[i]+"/Media/rooms/**/*.room");
            $('#choiceTreeUL').append('<li>'+dirs[i]+'<ul id="choiceTreeLis'+i+'">');
            for(var j = 0; j < rooms[i].length; ++j){
                $('#choiceTreeLis'+i).append('<li><input type="radio" name="myChoice" value="'+rooms[i][j]+'">'+rooms[i][j].substring(rooms[i][j].lastIndexOf("/")+1)+'</li>');
            }
            $('#choiceTreeUL').append('</ul></li>');
        }
        return rooms;
    }


    function getDirectories(srcpath) {
      var fs = require('fs'), path = require('path');
      return fs.readdirSync(srcpath).filter(function(file) {
        return fs.statSync(path.join(srcpath, file)).isDirectory();
      });
    }
</script>
</html>
